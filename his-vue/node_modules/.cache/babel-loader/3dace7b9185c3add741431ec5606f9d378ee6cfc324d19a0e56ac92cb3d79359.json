{"ast":null,"code":"export default {\n  data() {\n    return {\n      levelPage: {},\n      queryCondition: {\n        levelName: '',\n        currentPage: 1,\n        pageSize: 10\n      },\n      OpenDialog: false,\n      formData: {\n        levelId: 0,\n        levelName: '',\n        levelAmount: ''\n      },\n      formRules: {\n        levelName: [{\n          required: true,\n          message: '请输入挂号级别名称',\n          trigger: 'blur'\n        }, {\n          max: 10,\n          message: '挂号级别的长度不能超过十个字符',\n          trigger: 'blur'\n        }],\n        levelAmount: [{\n          required: true,\n          message: '请输入挂号级别费用',\n          trigger: 'blur'\n        }, {\n          type: 'number',\n          message: '挂号级别费用必须是数字',\n          trigger: 'blur'\n        }]\n      },\n      actionType: '',\n      levels: []\n    };\n  },\n  methods: {\n    //查询 挂号级别\n    getLevelList() {\n      this.$http.get('/api/level/list', {\n        params: this.queryCondition\n      }).then(res => {\n        console.log(res);\n        this.levelPage = res.data.data.levelPage;\n      });\n    },\n    handleSizeChange(val) {\n      this.queryCondition.pageSize = val;\n      this.getLevelList();\n    },\n    handleCurrentChange(val) {\n      this.queryCondition.currentPage = val;\n      this.getLevelList();\n    },\n    handleSelectionChange(val) {\n      this.levels = val;\n    },\n    add() {\n      this.formData = {};\n      this.actionType = '添加挂号级别';\n      this.OpenDialog = true;\n    },\n    addOrModify() {\n      this.$refs.formRef.validate(valid => {\n        if (valid) {\n          if (this.actionType == '添加挂号级别') {\n            this.$http.post('/api/level/add', this.formData).then(res => {\n              if (res.data.status == 1) {\n                this.$message.success(res.data.message);\n                this.getLevelList();\n              } else {\n                this.$message.error(res.data.message);\n              }\n            });\n          } else {\n            this.$http.put('/api/level/modify', this.formData).then(res => {\n              if (res.data.status == 1) {\n                this.$message.success(res.data.message);\n                this.getLevelList();\n              } else {\n                this.$message.error(res.data.message);\n              }\n            });\n          }\n          this.OpenDialog = false;\n        } else {\n          this.$message.error(\"输入数据有误，请检查后再提交\");\n        }\n      });\n    },\n    modify(levelId) {\n      this.$http.get('/api/level/get/' + levelId).then(res => {\n        if (res.data.status == 1) {\n          this.formData = res.data.data.level;\n          this.actionType = '修改挂号级别';\n          this.OpenDialog = true;\n        } else {\n          this.$message.error(res.data.message);\n        }\n      });\n    },\n    async remove(levelId, levelName) {\n      let removeEnableFlag = false;\n      await this.$http.get('/api/level/removeEnable/' + levelId).then(res => {\n        removeEnableFlag = res.data.status == 1;\n      });\n      if (removeEnableFlag) {\n        const result = await this.$confirm('是否确认删除【' + levelName + '】', '删除确认', {\n          confirmButtonText: '删除',\n          cancelButtonText: '取消',\n          type: 'warning'\n        });\n        if (result == 'confirm') {\n          this.$http.delete('/api/level/remove/' + levelId).then(res => {\n            if (res.data.status == 1) {\n              this.$message.success(res.data.message);\n              this.getLevelList();\n            } else {\n              this.$message.error(res.data.message);\n            }\n          });\n        }\n      } else {\n        this.$message.error('当前挂号级别下存在医生，不能删除');\n      }\n    },\n    async deleteBatch() {\n      let levelIds = '';\n      let levelNames = '';\n      this.levels.forEach(level => {\n        levelIds += level.levelId + ',';\n        levelNames += level.levelName + ',';\n      });\n      levelIds = levelIds.substring(0, levelIds.length - 1);\n      levelNames = levelNames.substring(0, levelNames.length - 1);\n      const result = await this.$confirm('是否确认删除【' + levelNames + '】', '删除确认', {\n        confirmButtonText: '删除',\n        cancelButtonText: '取消',\n        type: 'warning'\n      });\n      if (result == 'confirm') {\n        this.$http.delete('/api/level/deleteBatch?levelIds=' + levelIds).then(res => {\n          if (res.data.status == 1) {\n            this.$message.success(res.data.message);\n            this.getLevelList();\n          } else {\n            this.$message.error(res.data.message);\n          }\n        });\n      }\n    }\n  },\n  mounted() {\n    this.getLevelList();\n  }\n};","map":{"version":3,"names":["data","levelPage","queryCondition","levelName","currentPage","pageSize","OpenDialog","formData","levelId","levelAmount","formRules","required","message","trigger","max","type","actionType","levels","methods","getLevelList","$http","get","params","then","res","console","log","handleSizeChange","val","handleCurrentChange","handleSelectionChange","add","addOrModify","$refs","formRef","validate","valid","post","status","$message","success","error","put","modify","level","remove","removeEnableFlag","result","$confirm","confirmButtonText","cancelButtonText","delete","deleteBatch","levelIds","levelNames","forEach","substring","length","mounted"],"sources":["src/views/data/Level.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t\r\n\t\t<!-- 面包屑导航 -->\r\n\t\t<el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n\t\t  <el-breadcrumb-item :to=\"{path: '/welcome'}\">首页</el-breadcrumb-item>\r\n\t\t  <el-breadcrumb-item>基础数据</el-breadcrumb-item>\r\n\t\t  <el-breadcrumb-item>挂号级别管理</el-breadcrumb-item>\r\n\t\t</el-breadcrumb>\r\n\t\t\r\n\t\t<!-- 卡片容器 -->\r\n\t\t<el-card>\r\n\r\n      <el-input v-model=\"queryCondition.levelName\" placeholder=\"挂号级别名称\" style=\"width: 250px\"></el-input>\r\n      <el-button type=\"primary\" style=\"margin-left: 30px\" @click=\"getLevelList\">查询</el-button>\r\n      <el-button type=\"primary\"  @click=\"add\" class=\"add-button\">添加挂号级别</el-button>\r\n      <el-button type=\"danger\" @click=\"deleteBatch\" class=\"delete-button\">批量删除</el-button>\r\n\t\t\t<!-- 数据表格 -->\r\n\t\t\t<el-table :data=\"levelPage.records\" style=\"width: 80%\" stripe border @selection-change=\"handleSelectionChange\">\r\n\r\n        <el-table-column type=\"selection\"/>\r\n          <el-table-column prop=\"levelId\" label=\"级别编号\">\r\n          </el-table-column>\r\n\r\n          <el-table-column prop=\"levelName\" label=\"级别名称\">\r\n          </el-table-column>\r\n\r\n          <el-table-column prop=\"levelAmount\" label=\"级别费用\">\r\n          </el-table-column>\r\n\r\n          <el-table-column label=\"操作\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button type=\"primary\" size=\"mini\" icon=\"el-icon-edit\" @click=\"modify(scope.row.levelId)\" ></el-button>\r\n              <el-button type=\"danger\" size=\"mini\" icon=\"el-icon-delete\" @click=\"remove(scope.row.levelId,scope.row.levelName)\"></el-button>\r\n            </template>\r\n          </el-table-column>\r\n\t\t\t    </el-table>\r\n      <el-pagination\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :current-page=\"queryCondition.currentPage\"\r\n          :page-sizes=\"[2, 4, 5, 10]\"\r\n          :page-size=\"queryCondition.pageSize\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"levelPage.total\">\r\n      </el-pagination>\r\n\r\n\t\t</el-card>\r\n\r\n\r\n    <el-dialog :title=\"actionType\" :visible.sync=\"OpenDialog\" width=\"30%\" center>\r\n      <el-form :model=\"formData\" :rules=\"formRules\" ref=\"formRef\">\r\n        <el-form-item label=\"级别名称\" label-width=\"100px\" :label-width=\"levelName\">\r\n          <el-input v-model=\"formData.levelName\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"级别费用\" label-width=\"100px\" :label-width=\"levelAmount\">\r\n          <el-input v-model.number=\"formData.levelAmount\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\">\r\n        <el-button @click=\"OpenDialog = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"addOrModify\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\t\r\n\t    data() {\r\n\t\t\t\r\n\t        return {\r\n\r\n            levelPage: {},\r\n\r\n            queryCondition:{\r\n              levelName:'',\r\n              currentPage:1,\r\n              pageSize:10,\r\n            },\r\n            OpenDialog:false,\r\n\r\n            formData:{\r\n              levelId:0,\r\n              levelName: '',\r\n              levelAmount:'',\r\n            },\r\n            formRules:{\r\n              levelName:[\r\n                { required:true, message:'请输入挂号级别名称',trigger:'blur'},\r\n                { max:10, message: '挂号级别的长度不能超过十个字符',trigger:'blur'}\r\n              ],\r\n\r\n              levelAmount:[\r\n                { required:true, message:'请输入挂号级别费用',trigger:'blur'},\r\n                { type:'number', message: '挂号级别费用必须是数字',trigger:'blur'}\r\n              ]\r\n            },\r\n            actionType:'',\r\n            levels:[],\r\n\t        }\r\n\t    },\r\n  methods: {\r\n        //查询 挂号级别\r\n        getLevelList(){\r\n          this.$http.get('/api/level/list', {params:this.queryCondition}).then(\r\n              res => {\r\n                console.log(res)\r\n                this.levelPage = res.data.data.levelPage\r\n              }\r\n          )\r\n        },\r\n\r\n        handleSizeChange(val) {\r\n          this.queryCondition.pageSize = val;\r\n          this.getLevelList();\r\n        },\r\n        handleCurrentChange(val) {\r\n          this.queryCondition.currentPage = val;\r\n          this.getLevelList();\r\n        },\r\n\r\n        handleSelectionChange(val){\r\n          this.levels = val\r\n        },\r\n        add(){\r\n          this.formData={}\r\n\r\n          this.actionType='添加挂号级别'\r\n\r\n          this.OpenDialog=true\r\n        },\r\n        addOrModify(){\r\n          this.$refs.formRef.validate(\r\n              valid =>{\r\n                if(valid){\r\n                  if(this.actionType=='添加挂号级别'){\r\n                    this.$http.post('/api/level/add', this.formData).then(\r\n                        res => {\r\n                          if(res.data.status == 1){\r\n                            this.$message.success(res.data.message)\r\n\r\n                            this.getLevelList()\r\n                          }else{\r\n                            this.$message.error(res.data.message)\r\n                          }\r\n                        }\r\n                    )\r\n                  }else{\r\n                    this.$http.put('/api/level/modify', this.formData).then(\r\n                        res => {\r\n                          if(res.data.status == 1){\r\n                            this.$message.success(res.data.message)\r\n\r\n                            this.getLevelList()\r\n                          }else{\r\n                            this.$message.error(res.data.message)\r\n                          }\r\n                        }\r\n                    )\r\n                  }\r\n                  this.OpenDialog= false\r\n                }else{\r\n                  this.$message.error(\"输入数据有误，请检查后再提交\")\r\n                }\r\n              }\r\n          )\r\n        },\r\n        modify(levelId){\r\n          this.$http.get('/api/level/get/'+levelId).then(\r\n              res => {\r\n                if(res.data.status == 1){\r\n                  this.formData = res.data.data.level;\r\n\r\n                  this.actionType='修改挂号级别';\r\n\r\n                  this.OpenDialog=true;\r\n\r\n                }else{\r\n                  this.$message.error(res.data.message)\r\n                }\r\n              }\r\n          )\r\n        },\r\n\r\n        async remove(levelId, levelName){\r\n          let removeEnableFlag = false;\r\n\r\n          await this.$http.get('/api/level/removeEnable/' + levelId).then(\r\n              res => {\r\n                removeEnableFlag = (res.data.status == 1)\r\n              }\r\n          )\r\n\r\n          if(removeEnableFlag){\r\n\r\n            const result = await this.$confirm(\r\n                '是否确认删除【'+levelName+'】','删除确认',\r\n                {\r\n                  confirmButtonText:'删除',\r\n                  cancelButtonText:'取消',\r\n                  type:'warning'\r\n                }\r\n            )\r\n\r\n            if(result == 'confirm'){\r\n              this.$http.delete('/api/level/remove/'+levelId).then(\r\n                  res => {\r\n                    if(res.data.status == 1){\r\n                      this.$message.success(res.data.message)\r\n\r\n                      this.getLevelList()\r\n                    }else{\r\n                      this.$message.error(res.data.message)\r\n                    }\r\n                  }\r\n              )\r\n            }\r\n          }else{\r\n            this.$message.error('当前挂号级别下存在医生，不能删除')\r\n          }\r\n        },\r\n        async deleteBatch(){\r\n\r\n          let levelIds = ''\r\n          let levelNames = ''\r\n\r\n          this.levels.forEach( level => {\r\n            levelIds += level.levelId + ','\r\n            levelNames += level.levelName + ','\r\n          })\r\n\r\n          levelIds = levelIds.substring(0, levelIds.length - 1)\r\n          levelNames = levelNames.substring(0, levelNames.length - 1)\r\n\r\n          const result = await this.$confirm(\r\n              '是否确认删除【' + levelNames + '】','删除确认',\r\n              {\r\n                confirmButtonText:'删除',\r\n                cancelButtonText:'取消',\r\n                type:'warning'\r\n              }\r\n          )\r\n          if(result == 'confirm'){\r\n            this.$http.delete('/api/level/deleteBatch?levelIds='+levelIds).then(\r\n                res => {\r\n                  if(res.data.status == 1){\r\n                    this.$message.success(res.data.message)\r\n\r\n                    this.getLevelList()\r\n                  }else{\r\n                    this.$message.error(res.data.message)\r\n                  }\r\n                }\r\n            )\r\n          }\r\n        },\r\n      },\r\n      mounted(){\r\n\r\n        this.getLevelList();\r\n      }\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n.add-button{\r\n  position: absolute;\r\n  right: 80px;\r\n  width: 120px;\r\n}\r\n.delete-button{\r\n  position: absolute;\r\n  right: 240px;\r\n}\r\n\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}